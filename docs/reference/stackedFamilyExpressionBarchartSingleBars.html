<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Print expression stacked bar graph for HUGO gene groups most preferentially expressed in
selected putative CSCs. — stackedFamilyExpressionBarchartSingleBars • CSCPlots</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Print expression stacked bar graph for HUGO gene groups most preferentially expressed in
selected putative CSCs. — stackedFamilyExpressionBarchartSingleBars" />
<meta property="og:description" content="This function prints a stacked bar graph to display expression in HUGO gene groups most
preferentially expressed in a selected set of putative CSCs. This may use expression in the
form of read counts, TPM, TPM count fractions, Cells Per Million, etc. Cells Per Million or
TPM count fractions are recommended for tumour cell populations containing a mix of cell types.
Read counts are recommended for homogenous cell populations e.g. PDXs, CDXs. The height of
each bar is the average expression value for the members of a HUGO gene group in the cells
of the selected pCSC group. Each bar is subdivided by the proportion of the gene group
average expression contributed by each gene; subdivisions are labelled with gene names, and
where the subdivision is too small to fit the gene name in the graphic they are labelled
nearby. Bars are ordered by the HUGO gene group average expression value for the pCSC group
minus the gene group average expression in all tumour cells from all patients; the difference
between the pCSC group average expression and all tumour cells average expression is shown by
a pink dashed line. Other horizontal lines: the pCSC group’s source patient average expression
value for all tumour cells = dashed green line; average expression value for tumour cells from
all patients = red dashed line; all cells from all patients (e.g. including immune cells)
average expression value = blue dashed line; and the average expression value for all
transcripts in the pCSC group = black dotted line. N.B. not all genes officially defined in
a HUGO gene group are present in the scRNA-Seq dataset, depending on the experimental platform
used." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CSCPlots</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/tutorial_2.html">CSCPlots Tutorial 2</a>
    </li>
    <li>
      <a href="../articles/tutorial_3.html">CSCPlots Tutorial 3</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Print expression stacked bar graph for HUGO gene groups most preferentially expressed in
selected putative CSCs.</h1>
    
    <div class="hidden name"><code>stackedFamilyExpressionBarchartSingleBars.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function prints a stacked bar graph to display expression in HUGO gene groups most
preferentially expressed in a selected set of putative CSCs. This may use expression in the
form of read counts, TPM, TPM count fractions, Cells Per Million, etc. Cells Per Million or
TPM count fractions are recommended for tumour cell populations containing a mix of cell types.
Read counts are recommended for homogenous cell populations e.g. PDXs, CDXs. The height of
each bar is the average expression value for the members of a HUGO gene group in the cells
of the selected pCSC group. Each bar is subdivided by the proportion of the gene group
average expression contributed by each gene; subdivisions are labelled with gene names, and
where the subdivision is too small to fit the gene name in the graphic they are labelled
nearby. Bars are ordered by the HUGO gene group average expression value for the pCSC group
minus the gene group average expression in all tumour cells from all patients; the difference
between the pCSC group average expression and all tumour cells average expression is shown by
a pink dashed line. Other horizontal lines: the pCSC group’s source patient average expression
value for all tumour cells = dashed green line; average expression value for tumour cells from
all patients = red dashed line; all cells from all patients (e.g. including immune cells)
average expression value = blue dashed line; and the average expression value for all
transcripts in the pCSC group = black dotted line. N.B. not all genes officially defined in
a HUGO gene group are present in the scRNA-Seq dataset, depending on the experimental platform
used.</p>
    </div>

    <pre class="usage"><span class='fu'>stackedFamilyExpressionBarchartSingleBars</span><span class='op'>(</span>
  <span class='va'>tExprMatr</span>,
  <span class='va'>pCSC_group_positions</span>,
  <span class='va'>tumour_only_positions</span>,
  <span class='va'>this_patient_tumour_only_positions</span>,
  <span class='va'>HUGO_groups_sets_of_columnNumbers</span>,
  <span class='va'>pCSC_group_name</span>,
  <span class='va'>outDir</span>,
  <span class='va'>tissue_type</span>,
  <span class='va'>family_type_name</span>,
  <span class='va'>patient_source_name</span>,
  <span class='va'>frag_count_method</span>,
  separate_row_for_high_expression_transcripts <span class='op'>=</span> <span class='cn'>NULL</span>,
  manually_set_max_number_of_graph_rows <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>tExprMatr</th>
      <td><p>Expression matrix describing a cancer single-cell population; column
names should be gene names, row names should be cancer cell names.</p></td>
    </tr>
    <tr>
      <th>pCSC_group_positions</th>
      <td><p>Row number of CSCs in the CSC group in the expression matrix
tExprMatr.</p></td>
    </tr>
    <tr>
      <th>tumour_only_positions</th>
      <td><p>Positions (row numbers) in the expression matrix tExprMatr
thought to be tumour cells e.g. when the population contains cells annotated or predicted
as other cell types a subset may be defined, or if all cells are thought to be malignant
cancer cells this may be all cells.</p></td>
    </tr>
    <tr>
      <th>this_patient_tumour_only_positions</th>
      <td><p>Optional: Expression matrix tExprMatr positions
(row numbers) for tumour cells from a specific patient i.e. that the CSCs for the
preferential expression plots are taken from. So, the plot needs to fulfil the criteria
that the CSCs are from only one patient, but the tumour cell population is from multiple
patients.</p></td>
    </tr>
    <tr>
      <th>HUGO_groups_sets_of_columnNumbers</th>
      <td><p>List of lists, i.e. a list of HUGO gene groups,
with each named gene group containing positions (row numbers) in the expression matrix
tExprMatr of all the gene group members present in the expression matrix.</p></td>
    </tr>
    <tr>
      <th>pCSC_group_name</th>
      <td><p>Name of CSC group to print preferential expression plots for
e.g. 'pCSC_group_1_SC4_Talazoparib.LB17011', but can be anything.</p></td>
    </tr>
    <tr>
      <th>outDir</th>
      <td><p>Output directory for plots.</p></td>
    </tr>
    <tr>
      <th>tissue_type</th>
      <td><p>Name of tissue type e.g. 'CDX'; can be anything.</p></td>
    </tr>
    <tr>
      <th>family_type_name</th>
      <td><p>Name of the gene group type; usually 'HUGO'.</p></td>
    </tr>
    <tr>
      <th>patient_source_name</th>
      <td><p>Optional: Name of the patient sample that CSC cells are from;
just name for in the plot title, can be anything.</p></td>
    </tr>
    <tr>
      <th>frag_count_method</th>
      <td><p>Expression measurement type, e.g. 'raw'; but just a label, can be anything.</p></td>
    </tr>
    <tr>
      <th>separate_row_for_high_expression_transcripts</th>
      <td><p>Optional: Set to 1 to print very high
expression transcripts or gene groups on a separate row in some of the bar charts; helpful
when there is a big difference between the most highly expressed and those on the same
bar chart row.</p></td>
    </tr>
    <tr>
      <th>manually_set_max_number_of_graph_rows</th>
      <td><p>Optional: Set to manually override the
maximum number of rows shown in the stacked family plot.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>List of highest ranked preferentially expressed genes and gene families:
- ranked families from family barcharts;
- ranked transcripts from family barcharts.</p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Phil Carter.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


